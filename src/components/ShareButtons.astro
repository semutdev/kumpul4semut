---
export interface Props {
  title: string;
  url: string;
}

const { title, url } = Astro.props;

const encodedTitle = encodeURIComponent(title);
const encodedUrl = encodeURIComponent(url);
---

<div class="flex items-center gap-3 py-4">
  <span class="text-sm font-medium text-gray-700 dark:text-gray-300"
    >Share:</span
  >

  <!-- Twitter/X -->
  <a
    href={`https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`}
    target="_blank"
    rel="noopener noreferrer"
    class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-blue-500 hover:text-white transition-colors no-underline"
    aria-label="Share on Twitter"
  >
    <svg
      class="w-5 h-5"
      fill="currentColor"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path
        d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"
      ></path>
    </svg>
  </a>

  <!-- LinkedIn -->
  <a
    href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodedUrl}`}
    target="_blank"
    rel="noopener noreferrer"
    class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-blue-700 hover:text-white transition-colors no-underline"
    aria-label="Share on LinkedIn"
  >
    <svg
      class="w-5 h-5"
      fill="currentColor"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path
        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
      ></path>
    </svg>
  </a>

  <!-- Copy Link -->
  <button
    type="button"
    class="copy-link-button inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-green-500 hover:text-white transition-colors"
    data-url={url}
    aria-label="Copy link to clipboard"
  >
    <svg
      class="w-5 h-5"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"
      ></path>
    </svg>
  </button>

  <!-- Toast notification (hidden by default) -->
  <div
    class="copy-toast hidden fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50"
  >
    Link copied!
  </div>
</div>

<script>
  // Copy link functionality
  document.addEventListener("DOMContentLoaded", () => {
    const copyButtons = document.querySelectorAll(".copy-link-button");

    copyButtons.forEach((button) => {
      button.addEventListener("click", async () => {
        const url = button.getAttribute("data-url");
        const toast = document.querySelector(".copy-toast");

        if (url) {
          try {
            // Try using the Web Share API first (mobile devices)
            if (navigator.share) {
              await navigator.share({
                title: document.title,
                url: url,
              });
            } else {
              // Fallback to clipboard API
              await navigator.clipboard.writeText(url);

              // Show toast notification
              if (toast) {
                toast.classList.remove("hidden");
                setTimeout(() => {
                  toast.classList.add("hidden");
                }, 2000);
              }
            }
          } catch (err) {
            console.error("Failed to share:", err);
          }
        }
      });
    });
  });
</script>
